install.packages("ggplot2")
install.packages("ggplot2")
knitr::opts_chunk$set(echo = TRUE)
library(Amelia)
library(ggplot2)
library(tidyverse)
library(readxl)
ggtsdisplay(ts.atm1, points = FALSE, plot.type = "histogram")
install.packages("forecast")
install.packages("fttp2")
install.packages("fpp2")
library(Amelia)
library(ggplot2)
library(forecast)
library(fpp2)
library(tidyverse)
library(readxl)
ggtsdisplay(ts.atm1, points = FALSE, plot.type = "histogram")
par(mfrow = c(2,4))
hist(df.atm1$Cash, col = 'red')
hist(df.atm2$Cash, col = 'green')
hist(df.atm3$Cash, col = 'blue')
hist(df.atm4$Cash, col = 'yellow')
boxplot(df.atm1$Cash, col = 'red')
boxplot(df.atm2$Cash, col = 'green')
boxplot(df.atm3$Cash, col = 'blue')
boxplot(df.atm4$Cash, col = 'yellow')
par(mfrow = c(2,4))
hist(df.atm1$Cash, main = 'ATM 1 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'red')
hist(df.atm2$Cash, main = 'ATM 2 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'green')
hist(df.atm3$Cash, main = 'ATM 3 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'blue')
hist(df.atm4$Cash, main = 'ATM 4 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'yellow')
boxplot(df.atm1$Cash, col = 'red')
boxplot(df.atm2$Cash, col = 'green')
boxplot(df.atm3$Cash, col = 'blue')
boxplot(df.atm4$Cash, col = 'yellow')
par(mfrow = c(2,4))
hist(df.atm1$Cash, main = 'ATM 1 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'red')
hist(df.atm2$Cash, main = 'ATM 2 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'green')
hist(df.atm3$Cash, main = 'ATM 3 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'blue')
hist(df.atm4$Cash, main = 'ATM 4 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'yellow')
boxplot(df.atm1$Cash, main = 'ATM 1 Boxplot', xlab = 'Cash', ylab = 'Frequency', col = 'red')
boxplot(df.atm2$Cash, col = 'green')
boxplot(df.atm3$Cash, col = 'blue')
boxplot(df.atm4$Cash, col = 'yellow')
par(mfrow = c(2,4))
hist(df.atm1$Cash, main = 'ATM 1 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'red')
hist(df.atm2$Cash, main = 'ATM 2 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'green')
hist(df.atm3$Cash, main = 'ATM 3 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'blue')
hist(df.atm4$Cash, main = 'ATM 4 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'yellow')
boxplot(df.atm1$Cash, main = 'ATM 1 Boxplot', xlab = 'ATM 1', ylab = 'Cash', col = 'red')
boxplot(df.atm2$Cash, col = 'green')
boxplot(df.atm3$Cash, col = 'blue')
boxplot(df.atm4$Cash, col = 'yellow')
par(mfrow = c(2,4))
hist(df.atm1$Cash, main = 'ATM 1 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'red')
hist(df.atm2$Cash, main = 'ATM 2 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'green')
hist(df.atm3$Cash, main = 'ATM 3 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'blue')
hist(df.atm4$Cash, main = 'ATM 4 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'yellow')
boxplot(df.atm1$Cash, main = 'ATM 1 Boxplot', xlab = 'ATM 1', ylab = 'Cash', col = 'red')
boxplot(df.atm2$Cash, main = 'ATM 2 Boxplot', xlab = 'ATM 2', ylab = 'Cash', col = 'green')
boxplot(df.atm3$Cash, main = 'ATM 3 Boxplot', xlab = 'ATM 3', ylab = 'Cash', col = 'blue')
boxplot(df.atm4$Cash, main = 'ATM 4 Boxplot', xlab = 'ATM 4', ylab = 'Cash', col = 'yellow')
ggtsdisplay(ts.atm1, points = FALSE, plot.type = "histogram")
par(mfrow = c(4,1))
plot(df.atm1, type = 'l', col = 'red')
plot(df.atm2, type = 'l', col = 'green')
plot(df.atm3, type = 'l', col = 'blue')
plot(df.atm4, type = 'o', col = 'yellow')
df.atm1 <- subset(df.atm, df.atm$ATM == 'ATM1')
df.atm1 <- df.atm1[c('DATE', 'Cash')]
missmap(df.atm1)
df.atm2 <- subset(df.atm, df.atm$ATM == 'ATM2')
df.atm2 <- df.atm2[c('DATE', 'Cash')]
missmap(df.atm2)
df.atm3 <- subset(df.atm, df.atm$ATM == 'ATM3')
df.atm3 <- df.atm3[c('DATE', 'Cash')]
missmap(df.atm3)
df.atm4 <- subset(df.atm, df.atm$ATM == 'ATM4')
df.atm4 <- df.atm4[c('DATE', 'Cash')]
missmap(df.atm3)
df.atm1 <- subset(df.atm, df.atm$ATM == 'ATM1')
df.atm1 <- df.atm1[c('DATE', 'Cash')]
summary(df.atm1)
missmap(df.atm1)
df.atm2 <- subset(df.atm, df.atm$ATM == 'ATM2')
df.atm2 <- df.atm2[c('DATE', 'Cash')]
summary(df.atm2)
missmap(df.atm2)
df.atm3 <- subset(df.atm, df.atm$ATM == 'ATM3')
df.atm3 <- df.atm3[c('DATE', 'Cash')]
summary(df.atm3)
missmap(df.atm3)
df.atm4 <- subset(df.atm, df.atm$ATM == 'ATM4')
df.atm4 <- df.atm4[c('DATE', 'Cash')]
summary(df.atm4)
missmap(df.atm5)
df.atm4 <- subset(df.atm, df.atm$ATM == 'ATM4')
df.atm4 <- df.atm4[c('DATE', 'Cash')]
summary(df.atm4)
missmap(df.atm4)
df.atm1 <- drop_na(df.atm1)
df.atm2 <- drop_na(df.atm2)
par(mfrow = c(2,4))
hist(df.atm1$Cash, main = 'ATM 1 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'red')
hist(df.atm2$Cash, main = 'ATM 2 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'green')
hist(df.atm3$Cash, main = 'ATM 3 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'blue')
hist(df.atm4$Cash, main = 'ATM 4 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'yellow')
boxplot(df.atm1$Cash, main = 'ATM 1 Boxplot', xlab = 'ATM 1', ylab = 'Cash', col = 'red')
boxplot(df.atm2$Cash, main = 'ATM 2 Boxplot', xlab = 'ATM 2', ylab = 'Cash', col = 'green')
boxplot(df.atm3$Cash, main = 'ATM 3 Boxplot', xlab = 'ATM 3', ylab = 'Cash', col = 'blue')
boxplot(df.atm4$Cash, main = 'ATM 4 Boxplot', xlab = 'ATM 4', ylab = 'Cash', col = 'yellow')
plot(df.atm1, type = 'l', col = 'red')
plot(df.atm2, type = 'l', col = 'green')
plot(df.atm3, type = 'l', col = 'blue')
plot(df.atm4, type = 'l', col = 'yellow')
plot(df.atm1, type = 'l', col = 'red')
plot(df.atm2, type = 'l', col = 'green')
plot(df.atm3, type = 'l', col = 'blue')
plot(df.atm4, type = 'l', col = 'darkyellow')
plot(df.atm1, type = 'l', col = 'red')
plot(df.atm2, type = 'l', col = 'green')
plot(df.atm3, type = 'l', col = 'blue')
plot(df.atm4, type = 'l', col = 'gold')
par(mfrow = c(2,4))
hist(df.atm1$Cash, main = 'ATM 1 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'red')
hist(df.atm2$Cash, main = 'ATM 2 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'green')
hist(df.atm3$Cash, main = 'ATM 3 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'blue')
hist(df.atm4$Cash, main = 'ATM 4 Histogram', xlab = 'Cash', ylab = 'Frequency', col = 'gold')
boxplot(df.atm1$Cash, main = 'ATM 1 Boxplot', xlab = 'ATM 1', ylab = 'Cash', col = 'red')
boxplot(df.atm2$Cash, main = 'ATM 2 Boxplot', xlab = 'ATM 2', ylab = 'Cash', col = 'green')
boxplot(df.atm3$Cash, main = 'ATM 3 Boxplot', xlab = 'ATM 3', ylab = 'Cash', col = 'blue')
boxplot(df.atm4$Cash, main = 'ATM 4 Boxplot', xlab = 'ATM 4', ylab = 'Cash', col = 'gold')
plot(df.atm1, type = 'l', col = 'red')
plot(df.atm2, type = 'l', col = 'green')
plot(df.atm3, type = 'l', col = 'blue')
plot(df.atm4, type = 'l', col = 'gold')
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
library(Amelia)
library(ggplot2)
library(forecast)
library(fpp2)
library(tidyverse)
library(readxl)
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100)
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Eggs") + xlab("Time")
ggtsdisplay(ts.atm1, points = FALSE, plot.type = "histogram")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE, plot.type = "histogram")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE, plot.type = "histogram")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE)#, plot.type = "histogram")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE)#, plot.type = "histogram")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE)#, plot.type = "histogram")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 7)
ggtsdisplay(ts.atm1, points = FALSE)#, plot.type = "histogram")
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Eggs") + xlab("Time")
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 7)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 7)
ggtsdisplay(ts.atm1, points = FALSE)
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 100, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
ar.atm1 <- auto.arima(ts.atm1)
autoplot(forecast(ar.atm1, h = 100))
ar.atm1 <- auto.arima(ts.atm1)
autoplot(forecast(ar.atm1, h = 31))
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 31, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 31, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1
ts.atm1 %>% BoxCox(lam.atm1) %>% ggtsdisplay()
ht.atm1 <- holt(ts.atm1, lambda = BoxCox.lambda(ts.atm1), h = 31, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1))#, frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE)
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1
ts.atm1 %>% BoxCox(lam.atm1) %>% ggtsdisplay()
ts.atm1 <- ts(df.atm1$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm2 <- ts(df.atm2$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm3 <- ts(df.atm3$Cash, start = c(2009, 5, 1), frequency = 365)
ts.atm4 <- ts(df.atm4$Cash, start = c(2009, 5, 1), frequency = 365)
ggtsdisplay(ts.atm1, points = FALSE)
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1
ggtsdisplay(BoxCox(lam.atm1))
lam.atm1 <- BoxCox.lambda(ts.atm1)
lam.atm1
ggtsdisplay(BoxCox(ts.atm1, lam.atm1))
ar.atm1 <- auto.arima(ts.atm1)
autoplot(forecast(ar.atm1, h = 31))
accuracy(ht.atm1)
accuracy(ht.atm1)
checkresiduals(ht.atm1)
comparison <- data.frame(rbind(accuracy(ht.atm1), accuracy(ar.atm1)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
ar.atm1 <- auto.arima(ts.atm1)
autoplot(forecast(ar.atm1, h = 31))
accuracy(ar.atm1)
checkresiduals(ar.atm1)
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1
for.atm1 <- data.frame(forecast(ar.atm1, h = 31), remove_rownames())
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1 %>% remove_rownames()
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1[,1:]
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1[,3]
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1[,c(1,2,3,4)]
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
for.atm1[,c(2,3,4,5)]
for.atm1 <- data.frame(forecast(ar.atm1, h = 31))
remove_rownames(for.atm1)
ht.atm1 <- holt(ts.atm1, lambda = lam.atm1, h = 31, damped = TRUE)
autoplot(ht.atm1) +
autolayer(fitted(ht.atm1), series="Fitted") +
ylab("Cash") + xlab("Date")
ggtsdisplay(ts.atm2, points = FALSE)
lam.atm2 <- BoxCox.lambda(ts.atm2)
lam.atm2
ggtsdisplay(BoxCox(ts.atm2, lam.atm2))
ht.atm1 <- holt(ts.atm2, lambda = lam.atm2, h = 31, damped = TRUE)
autoplot(ht.atm2) +
autolayer(fitted(ht.atm2), series="Fitted") +
ylab("Cash") + xlab("Date")
ht.atm2 <- holt(ts.atm2, lambda = lam.atm2, h = 31, damped = TRUE)
autoplot(ht.atm2) +
autolayer(fitted(ht.atm2), series="Fitted") +
ylab("Cash") + xlab("Date")
accuracy(ht.atm2)
checkresiduals(ht.atm2)
ar.atm2 <- auto.arima(ts.atm2)
autoplot(forecast(ar.atm2, h = 31))
accuracy(ar.atm2)
checkresiduals(ar.atm2)
comparison <- data.frame(rbind(accuracy(ht.atm2), accuracy(ar.atm2)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
for.atm2 <- data.frame(forecast(ar.atm2, h = 31))
write_csv(remove_rownames(for.atm2), 'Forecast_ATM2.csv')
ggtsdisplay(ts.atm4, points = FALSE)
lam.atm4 <- BoxCox.lambda(ts.atm4)
lam.atm4
ggtsdisplay(BoxCox(ts.atm4, lam.atm4))
ht.atm4 <- holt(ts.atm4, lambda = lam.atm4, h = 31, damped = TRUE)
autoplot(ht.atm4) +
autolayer(fitted(ht.atm4), series="Fitted") +
ylab("Cash") + xlab("Date")
accuracy(ht.atm4)
checkresiduals(ht.atm4)
ar.atm4 <- auto.arima(ts.atm4)
autoplot(forecast(ar.atm4, h = 31))
accuracy(ar.atm4)
checkresiduals(ar.atm4)
comparison <- data.frame(rbind(accuracy(ht.atm4), accuracy(ar.atm4)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
ggtsdisplay(ts.atm4, points = FALSE)
lam.atm4 <- BoxCox.lambda(ts.atm4)
lam.atm4
ggtsdisplay(BoxCox(ts.atm4, lam.atm4))
ht.atm4 <- holt(ts.atm4, lambda = lam.atm4, h = 31, damped = TRUE)
autoplot(ht.atm4) +
autolayer(fitted(ht.atm4), series="Fitted") +
ylab("Cash") + xlab("Date")
accuracy(ht.atm4)
checkresiduals(ht.atm4)
ar.atm4 <- auto.arima(ts.atm4)
autoplot(forecast(ar.atm4, h = 31))
accuracy(ar.atm4)
checkresiduals(ar.atm4)
comparison <- data.frame(rbind(accuracy(ht.atm4), accuracy(ar.atm4)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
power <- read_excel('ResidentialCustomerForecastLoad-624.xlsx')
df.power <- data.frame(power)
power <- read_excel('ResidentialCustomerForecastLoad-624.xlsx')
df.power <- data.frame(power)
head(df.power)
dim(df.power)
match(df.power$YYYY.MMM, month.abb)
match(strsplit(df.power$YYYY.MMM, '-'), month.abb)
match(strsplit(df.power$YYYY.MMM, '-')[2], month.abb)
match((strsplit(df.power$YYYY.MMM, '-'))[2], month.abb)
strptime(df.power$YYYY.MMM. format = '%Y-%b')
strptime(df.power$YYYY.MMM, format = '%Y-%b')
strptime(df.power$YYYY.MMM, format = '%Y-%m')
as.date(df.power$YYYY.MMM, format = '%Y%m')
as.Date(df.power$YYYY.MMM, format = '%Y%m')
as.Date(df.power$YYYY.MMM, format = '%Y-%m')
as.Date(df.power$YYYY.MMM, format = '%Y-%b')
as.Date(toupper(df.power$YYYY.MMM), format = '%Y-%b')
as.Date(df.power$YYYY.MMM, format = '%Y-%B')
paste0(df.power)
paste0(df.power$YYYY.MMM, '-01')
as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d'
as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d')
as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d')
df.power$YYYY.MMM <- as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d')
head(df.power)
dim(df.power)
summary(df.power)
power <- read_excel('ResidentialCustomerForecastLoad-624.xlsx')
df.power <- data.frame(power)
head(df.power)
dim(df.power)
df.power$YYYY.MMM <- as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d')
head(df.power)
dim(df.power)
summary(df.power)
df.power <- drop_na(df.power)
summary(df.power)
par(mfrow = c(1,3))
hist(df.power$KWH)
boxplot(df.power$KWH)
missmap(df.power)
power <- read_excel('ResidentialCustomerForecastLoad-624.xlsx')
df.power <- data.frame(power)
head(df.power)
dim(df.power)
df.power$YYYY.MMM <- as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d')
head(df.power)
dim(df.power)
summary(df.power)
par(mfrow = c(1,3))
hist(df.power$KWH)
boxplot(df.power$KWH)
missmap(df.power)
df.power <- drop_na(df.power)
par(mfrow = c(1,3))
hist(df.power$KWH)
boxplot(df.power$KWH)
missmap(df.power)
df.power <- drop_na(df.power)
par(mfrow = c(1,2))
hist(df.power$KWH)
boxplot(df.power$KWH)
missmap(df.power)
df.power <- drop_na(df.power)
par(mfrow = c(1,2))
hist(df.power$KWH, col = 'yellow')
boxplot(df.power$KWH, col = 'yellow')
missmap(df.power)
par(mfrow = c(1,2))
hist(df.power$KWH, col = 'yellow')
boxplot(df.power$KWH, col = 'yellow')
missmap(df.power)
df.power <- drop_na(df.power)
par(mfrow = c(1,2))
hist(df.power$KWH, main = 'KWH Histogram', xlab = 'KWH', ylab = 'Frequency',col = 'yellow')
boxplot(df.power$KWH, main = 'KWH Boxplot', xlab = 'ATM 1', ylab = 'KWH', col = 'yellow')
missmap(df.power)
df.power <- drop_na(df.power)
par(mfrow = c(1,2))
hist(df.power$KWH, main = 'KWH Histogram', xlab = 'KWH', ylab = 'Frequency',col = 'yellow')
boxplot(df.power$KWH, main = 'KWH Boxplot', ylab = 'KWH', col = 'yellow')
missmap(df.power)
df.power <- drop_na(df.power)
df.power <- df.power[c('YYYY.MMM', 'KWH')]
par(mfrow = c(1,2))
hist(df.power$KWH, main = 'KWH Histogram', xlab = 'KWH', ylab = 'Frequency',col = 'yellow')
boxplot(df.power$KWH, main = 'KWH Boxplot', ylab = 'KWH', col = 'yellow')
missmap(df.power)
plot(df.power, type = 'l', col = 'yellow')
plot(df.power, type = 'l')
plot(df.power, type = 'l', xlab = 'Month')
ts.power <- ts(df.power$KWH, start = c(1998, 1, 1), frequency = 12)
ggtsdisplay(ts.power, points = FALSE)
lam.power <- BoxCox.lambda(ts.power)
lam.power
ggtsdisplay(BoxCox(ts.power, lam.power))
ht.power <- holt(ts.power, lambda = lam.power, h = 31, damped = TRUE)
autoplot(ht.power) +
autolayer(fitted(ht.power), series="Fitted") +
ylab("KWH") + xlab("Date")
accuracy(ht.power)
checkresiduals(ht.power)
ht.power <- holt(ts.power, lambda = lam.power, h = 1, damped = TRUE)
autoplot(ht.power) +
autolayer(fitted(ht.power), series="Fitted") +
ylab("KWH") + xlab("Date")
ar.power <- auto.arima(ts.power)
autoplot(forecast(ar.power, h = 1))
accuracy(ar.atm1)
checkresiduals(ar.atm1)
comparison <- data.frame(rbind(accuracy(ht.atm1), accuracy(ar.atm1)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
comparison <- data.frame(rbind(accuracy(ht.power), accuracy(ar.power)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
accuracy(ht.power)
checkresiduals(ht.power)
comparison <- data.frame(rbind(accuracy(ht.power), accuracy(ar.power)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
for.power <- data.frame(forecast(ar.power, h = 1))
write_csv(remove_rownames(for.power), 'Forecast_Power.csv')
comparison <- data.frame(rbind(accuracy(ht.power), accuracy(ar.power)))
rownames(comparison) <- c('Holt', 'ARIMA')
comparison
ht.power <- holt(ts.power, lambda = 0, h = 1, damped = TRUE)
autoplot(ht.power) +
autolayer(fitted(ht.power), series="Fitted") +
ylab("KWH") + xlab("Date")
accuracy(ht.power)
checkresiduals(ht.power)
ht.power <- holt(ts.power, lambda = lam.power, h = 1, damped = TRUE)
autoplot(ht.power) +
autolayer(fitted(ht.power), series="Fitted") +
ylab("KWH") + xlab("Date")
accuracy(ht.power)
checkresiduals(ht.power)
accuracy(ar.power)
checkresiduals(ar.power)
ht.power <- holt(ts.power, lambda = lam.power, h = 12, damped = TRUE)
autoplot(ht.power) +
autolayer(fitted(ht.power), series="Fitted") +
ylab("KWH") + xlab("Date")
accuracy(ht.power)
checkresiduals(ht.power)
ar.power <- auto.arima(ts.power)
autoplot(forecast(ar.power, h = 12))
accuracy(ar.power)
checkresiduals(ar.power)
par(mfrow = c(1,2))
hist(df.power$KWH, col = 'yellow')
boxplot(df.power$KWH, col = 'yellow')
missmap(df.power)
power <- read_excel('ResidentialCustomerForecastLoad-624.xlsx')
df.power <- data.frame(power)
head(df.power)
dim(df.power)
df.power$YYYY.MMM <- as.Date(paste0(df.power$YYYY.MMM, '-01'), format = '%Y-%b-%d')
head(df.power)
dim(df.power)
summary(df.power)
par(mfrow = c(1,2))
hist(df.power$KWH, col = 'yellow')
boxplot(df.power$KWH, col = 'yellow')
missmap(df.power)
